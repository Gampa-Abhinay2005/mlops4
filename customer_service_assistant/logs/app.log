2025-04-18 19:57:53.531 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x00000247A6C9EC00>
    â”” <Thread(WorkerThread-0, started 28996)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x00000247A6C9E8E0>
    â”” <Thread(WorkerThread-0, started 28996)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 28996)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 28996)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x00000247E6E66B90>>
    â”” <Thread(WorkerThread-0, started 28996)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000247AB477CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x00000247E6E66B90>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000247AB476FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x00000247E6AF43A0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000247AB477420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x00000247A8B7C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x00000247E6E7AC80>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x00000247E6D4B230>
           â”‚      â”” <function Runner.run at 0x00000247A8C77EC0>
           â”” <asyncio.runners.Runner object at 0x00000247E6E30610>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-28' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x00000247A8C759E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x00000247E6E30610>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x00000247A8C75940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x00000247A8C77740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x00000247A8B7CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x00000247E6AF43A0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp26vs6g84.wav'
                 â”” <function transcribe_audio at 0x00000247C40E4E00>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp26vs6g84.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x00000247D0551BC0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x00000247AD327010>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp26vs6g84.wav'
            â”” <function decode_audio at 0x00000247AD45F1A0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp26vs6g84.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp26vs6g84.wav'
2025-04-18 19:58:46.298 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x00000247A6C9EC00>
    â”” <Thread(WorkerThread-1, started 5952)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x00000247A6C9E8E0>
    â”” <Thread(WorkerThread-1, started 5952)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 5952)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 5952)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x00000247E728A050>>
    â”” <Thread(WorkerThread-1, started 5952)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000247AB477CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x00000247E728A050>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000247AB476FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x00000247E6AF4040>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000247AB477420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x00000247A8B7C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x00000247E72EBC80>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x00000247E6E69CF0>
           â”‚      â”” <function Runner.run at 0x00000247A8C77EC0>
           â”” <asyncio.runners.Runner object at 0x00000247E6E9CE50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-68' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x00000247A8C759E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x00000247E6E9CE50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x00000247A8C75940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x00000247A8C77740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x00000247A8B7CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x00000247E6AF4040>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp9sluv313.wav'
                 â”” <function transcribe_audio at 0x00000247C40E4E00>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp9sluv313.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x00000247D0551BC0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x00000247AD327010>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp9sluv313.wav'
            â”” <function decode_audio at 0x00000247AD45F1A0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp9sluv313.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp9sluv313.wav'
2025-04-18 19:58:59.957 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001EAE46BEC00>
    â”” <Thread(WorkerThread-0, started 29396)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001EAE46BE8E0>
    â”” <Thread(WorkerThread-0, started 29396)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 29396)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 29396)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001EAA4A67FD0>>
    â”” <Thread(WorkerThread-0, started 29396)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001EAE8DE7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001EAA4A67FD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001EAE8DE6FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001EAA46E57E0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001EAE8DE7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001EAE654C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001EAA4A53C40>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001EAA491EAC0>
           â”‚      â”” <function Runner.run at 0x000001EAE6627EC0>
           â”” <asyncio.runners.Runner object at 0x000001EAA4A31D10>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001EAE66259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001EAA4A31D10>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001EAE6625940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001EAE6627740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001EAE654CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001EAA46E57E0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpswnboppf.wav'
                 â”” <function transcribe_audio at 0x000001EAFFA58E00>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpswnboppf.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001EA8DF11BC0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001EAFFA62A50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpswnboppf.wav'
            â”” <function decode_audio at 0x000001EAEADCF1A0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpswnboppf.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpswnboppf.wav'
2025-04-18 19:59:29.885 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001EAE46BEC00>
    â”” <Thread(WorkerThread-1, started 34748)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001EAE46BE8E0>
    â”” <Thread(WorkerThread-1, started 34748)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 34748)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 34748)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001EAA4AE6BD0>>
    â”” <Thread(WorkerThread-1, started 34748)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001EAE8DE7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001EAA4AE6BD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001EAE8DE6FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001EAA4A4A9E0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001EAE8DE7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001EAE654C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001EAA4DEA500>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001EAA491D360>
           â”‚      â”” <function Runner.run at 0x000001EAE6627EC0>
           â”” <asyncio.runners.Runner object at 0x000001EAA4A77810>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-75' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001EAE66259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001EAA4A77810>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001EAE6625940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001EAE6627740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001EAE654CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001EAA4A4A9E0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjwowghyo.wav'
                 â”” <function transcribe_audio at 0x000001EAFFA58E00>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjwowghyo.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001EA8DF11BC0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001EAFFA62A50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjwowghyo.wav'
            â”” <function decode_audio at 0x000001EAEADCF1A0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjwowghyo.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjwowghyo.wav'
2025-04-18 20:00:56.020 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001D8D179EC00>
    â”” <Thread(WorkerThread-0, started 6008)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001D8D179E8E0>
    â”” <Thread(WorkerThread-0, started 6008)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 6008)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 6008)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001D894376210>>
    â”” <Thread(WorkerThread-0, started 6008)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001D8D5F07CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001D894376210>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001D8D5F06FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001D895F343A0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001D8D5F07420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001D8D371C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001D8962B3E40>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001D896172CE0>
           â”‚      â”” <function Runner.run at 0x000001D8D37D7EC0>
           â”” <asyncio.runners.Runner object at 0x000001D8962B0510>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001D8D37D59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001D8962B0510>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001D8D37D5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001D8D37D7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001D8D371CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001D895F343A0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp34qtzc9p.wav'
                 â”” <function transcribe_audio at 0x000001D8EEB78E00>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp34qtzc9p.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001D8FAF35C60>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001D8D7DB9C50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp34qtzc9p.wav'
            â”” <function decode_audio at 0x000001D8D82431A0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp34qtzc9p.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp34qtzc9p.wav'
2025-04-18 20:02:40.648 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001A9FFF0EC00>
    â”” <Thread(WorkerThread-0, started 17560)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001A9FFF0E8E0>
    â”” <Thread(WorkerThread-0, started 17560)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 17560)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 17560)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A9BE251DD0>>
    â”” <Thread(WorkerThread-0, started 17560)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001A984627CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A9BE251DD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001A984626FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_analysis at 0x000001A9C015C5F0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001A984627420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001A981E6C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001A9C0162F00>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001A9C010CBF0>
           â”‚      â”” <function Runner.run at 0x000001A981F27EC0>
           â”” <asyncio.runners.Runner object at 0x000001A9C0163190>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-37' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001A981F259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001A9C0163190>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001A981F25940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001A981F27740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001A981E6CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_analysis at 0x000001A9C015C5F0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 8, in transcribe_analysis
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
                 â”” <function transcribe_audio_and_identify_speakers at 0x000001A986962C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqc5p7oy3.wav'
                 â”” <function transcribe_audio at 0x000001A99D2A8E00>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqc5p7oy3.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001A9A98A9C60>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001A99D2B2AD0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqc5p7oy3.wav'
            â”” <function decode_audio at 0x000001A986962E80>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqc5p7oy3.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqc5p7oy3.wav'
2025-04-18 20:03:40.747 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001A9FFF0EC00>
    â”” <Thread(WorkerThread-1, started 26296)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001A9FFF0E8E0>
    â”” <Thread(WorkerThread-1, started 26296)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 26296)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 26296)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A9C04C0890>>
    â”” <Thread(WorkerThread-1, started 26296)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001A984627CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A9C04C0890>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001A984626FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_analysis at 0x000001A9C044B780>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001A984627420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001A981E6C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001A9C04EDA40>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001A9C0425BE0>
           â”‚      â”” <function Runner.run at 0x000001A981F27EC0>
           â”” <asyncio.runners.Runner object at 0x000001A9C017FD50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-82' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001A981F259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001A9C017FD50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001A981F25940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001A981F27740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001A981E6CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_analysis at 0x000001A9C044B780>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 8, in transcribe_analysis
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
                 â”” <function transcribe_audio_and_identify_speakers at 0x000001A986962C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp_b_qlyo1.wav'
                 â”” <function transcribe_audio at 0x000001A99D2A8E00>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp_b_qlyo1.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001A9A98A9C60>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001A99D2B2AD0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp_b_qlyo1.wav'
            â”” <function decode_audio at 0x000001A986962E80>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp_b_qlyo1.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp_b_qlyo1.wav'
2025-04-18 20:03:52.260 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:18 - Temporary file saved at: C:\Users\Abhi\AppData\Local\Temp\tmphb8nii49.wav, size: 3411443 bytes
2025-04-18 20:03:52.341 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:49 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000002478E9AEC00>
    â”” <Thread(WorkerThread-0, started 4888)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000002478E9AE8E0>
    â”” <Thread(WorkerThread-0, started 4888)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 4888)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 4888)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x00000247CE8624D0>>
    â”” <Thread(WorkerThread-0, started 4888)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x0000024793197CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x00000247CE8624D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x0000024793196FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_analysis at 0x00000247CEB9A400>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x0000024793197420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000002479089C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x00000247CEBD3D00>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x00000247CEA9ACE0>
           â”‚      â”” <function Runner.run at 0x0000024790A47EC0>
           â”” <asyncio.runners.Runner object at 0x00000247CEBD2990>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000024790A459E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x00000247CEBD2990>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000024790A45940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000024790A47740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000002479089CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_analysis at 0x00000247CEB9A400>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 8, in transcribe_analysis
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
                 â”” <function transcribe_audio_and_identify_speakers at 0x00000247954D2C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 24, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmphb8nii49.wav'
                 â”” <function transcribe_audio at 0x00000247ABE08EA0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmphb8nii49.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x00000247B829DD00>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000002479504FA90>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmphb8nii49.wav'
            â”” <function decode_audio at 0x00000247954D31A0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmphb8nii49.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmphb8nii49.wav'
2025-04-18 20:04:11.002 | INFO     | app.services.retrieval:get_retrieval_from_llm:12 - Retrieving information for query: i need fast post...
2025-04-18 20:04:11.002 | INFO     | app.llm:get_retrieval_response:37 - Retrieving information for query: i need fast post
2025-04-18 20:06:28.397 | INFO     | app.services.retrieval:get_retrieval_from_llm:12 - Retrieving information for query: how can i create an account...
2025-04-18 20:06:28.397 | INFO     | app.llm:get_retrieval_response:37 - Retrieving information for query: how can i create an account
2025-04-18 20:08:45.836 | INFO     | app.services.retrieval:get_retrieval_from_llm:12 - Retrieving information for query: what are the payment methods avalable...
2025-04-18 20:08:45.839 | INFO     | app.llm:get_retrieval_response:37 - Retrieving information for query: what are the payment methods avalable
2025-04-18 20:09:47.436 | INFO     | app.services.retrieval:get_retrieval_from_llm:12 - Retrieving information for query: what is the refund polocy...
2025-04-18 20:09:47.436 | INFO     | app.llm:get_retrieval_response:37 - Retrieving information for query: what is the refund polocy
2025-04-18 20:12:57.550 | INFO     | app.services.retrieval:get_retrieval_from_llm:12 - Retrieving information for query: what is the refund polocy...
2025-04-18 20:12:57.556 | INFO     | app.llm:get_retrieval_response:37 - Retrieving information for query: what is the refund polocy
2025-04-18 20:16:06.895 | INFO     | app.services.retrieval:retrieve_relevant_info:61 - Customer query: what is the refund polocy
2025-04-18 20:16:24.459 | INFO     | app.services.retrieval:retrieve_relevant_info:63 - Retrieved information: Here is the most relevant section extracted from the document:

"Items can be returned within 30 days of purchase in their original condition."

This sentence provides a clear answer to the customer's question about the refund policy, stating the time frame and conditions for returns.
2025-04-18 20:18:10.734 | INFO     | app.services.summarization:get_summary_from_llm:10 - Summarizing user query: i need fast post
how can i create an account
what ...
2025-04-18 20:18:10.734 | INFO     | app.llm:get_summarization_response:42 - Summarizing content for query: i need fast post
how can i create an account
what are the payment methods avalable
what is the refund polocy
what is the refund polocy
what is the refund polocy
2025-04-18 20:20:20.170 | INFO     | app.services.intent:get_intent_from_llm:10 - Getting intent for query: Here is the most relevant section extracted from t...
2025-04-18 20:20:20.170 | INFO     | app.llm:get_intent_response:47 - Determining intent for query: Here is the most relevant section extracted from the document:

"Items can be returned within 30 days of purchase in their original condition."

This sentence provides a clear answer to the customer's question about the refund policy, stating the time frame and conditions for returns.
2025-04-18 20:21:33.373 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:18 - Temporary file saved at: C:\Users\Abhi\AppData\Local\Temp\tmppmbmqhxp.wav, size: 3411443 bytes
2025-04-18 20:21:33.466 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:49 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000002A1063BEC00>
    â”” <Thread(WorkerThread-3, started 30840)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000002A1063BE8E0>
    â”” <Thread(WorkerThread-3, started 30840)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-3, started 30840)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-3, started 30840)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000002A14689F7D0>>
    â”” <Thread(WorkerThread-3, started 30840)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000002A10ABA7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000002A14689F7D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000002A10ABA6FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_analysis at 0x000002A1462E9560>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000002A10ABA7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000002A1082AC360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000002A1467D4580>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000002A1462E57A0>
           â”‚      â”” <function Runner.run at 0x000002A1083F7EC0>
           â”” <asyncio.runners.Runner object at 0x000002A1468045D0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-144' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000002A1083F59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000002A1468045D0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000002A1083F5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000002A1083F7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000002A1082ACEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_analysis at 0x000002A1462E9560>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 8, in transcribe_analysis
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
                 â”” <function transcribe_audio_and_identify_speakers at 0x000002A10CEE6C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 24, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppmbmqhxp.wav'
                 â”” <function transcribe_audio at 0x000002A123828EA0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppmbmqhxp.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000002A12FD99D00>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000002A10CA5A110>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppmbmqhxp.wav'
            â”” <function decode_audio at 0x000002A10CEE6E80>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppmbmqhxp.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppmbmqhxp.wav'
2025-04-18 20:22:56.029 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:18 - Temporary file saved at: C:\Users\Abhi\AppData\Local\Temp\tmpgwgvuzym.wav, size: 3411443 bytes
2025-04-18 20:22:56.151 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:49 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x00000156A008EC00>
    â”” <Thread(WorkerThread-0, started 37584)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x00000156A008E8E0>
    â”” <Thread(WorkerThread-0, started 37584)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 37584)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 37584)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x00000156E020E350>>
    â”” <Thread(WorkerThread-0, started 37584)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000156A4767CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x00000156E020E350>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000156A4766FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x00000156DFE81340>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000156A4767420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x00000156A1F1C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x00000156E026C500>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x00000156E0126CE0>
           â”‚      â”” <function Runner.run at 0x00000156A2087EC0>
           â”” <asyncio.runners.Runner object at 0x00000156E0266790>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x00000156A20859E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x00000156E0266790>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x00000156A2085940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x00000156A2087740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x00000156A1F1CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x00000156DFE81340>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 24, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpgwgvuzym.wav'
                 â”” <function transcribe_audio at 0x00000156BD3D8F40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpgwgvuzym.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x00000156C99ADDA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x00000156A661F2D0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpgwgvuzym.wav'
            â”” <function decode_audio at 0x00000156A6AA3100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpgwgvuzym.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpgwgvuzym.wav'
2025-04-18 20:24:00.623 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:18 - Temporary file saved at: C:\Users\Abhi\AppData\Local\Temp\tmp2elw65wq.wav, size: 3411443 bytes
2025-04-18 20:24:00.669 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:49 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x00000197B9FFEC00>
    â”” <Thread(WorkerThread-0, started 14316)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x00000197B9FFE8E0>
    â”” <Thread(WorkerThread-0, started 14316)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 14316)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 14316)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x00000197F9E8A2D0>>
    â”” <Thread(WorkerThread-0, started 14316)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000197BE737CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x00000197F9E8A2D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000197BE736FC0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_analysis at 0x00000197FA397D30>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000197BE737420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x00000197BBF5C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x00000197FA3F53C0>
           â”” transcribe_analysis(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-dispo...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x00000197FA0C18B0>
           â”‚      â”” <function Runner.run at 0x00000197BC017EC0>
           â”” <asyncio.runners.Runner object at 0x00000197FA3EF010>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-40' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x00000197BC0159E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x00000197FA3EF010>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x00000197BC015940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x00000197BC017740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x00000197BBF5CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_analysis at 0x00000197FA397D30>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 11, in transcribe_analysis
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
                 â”” <function transcribe_audio_and_identify_speakers at 0x00000197C0A72C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 24, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp2elw65wq.wav'
                 â”” <function transcribe_audio at 0x00000197D73B8F40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp2elw65wq.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x00000197E38B9DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x00000197C05EFD50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp2elw65wq.wav'
            â”” <function decode_audio at 0x00000197C0A73100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp2elw65wq.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp2elw65wq.wav'
2025-04-18 20:30:06.878 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001BF08E6EC00>
    â”” <Thread(WorkerThread-0, started 25856)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001BF08E6E8E0>
    â”” <Thread(WorkerThread-0, started 25856)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 25856)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 25856)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF48F7E990>>
    â”” <Thread(WorkerThread-0, started 25856)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001BF0D5E7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF48F7E990>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001BF0D5E6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF48D357E0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001BF0D5E7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001BF0AD6C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001BF490AC380>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001BF48F6A9B0>
           â”‚      â”” <function Runner.run at 0x000001BF0AE27EC0>
           â”” <asyncio.runners.Runner object at 0x000001BF49072950>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001BF0AE259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001BF49072950>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001BF0AE25940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001BF0AE27740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001BF0AD6CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF48D357E0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpup2qtk5g.wav'
                 â”” <function transcribe_audio at 0x000001BF26258EA0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpup2qtk5g.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001BF32679D00>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001BF26262C50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpup2qtk5g.wav'
            â”” <function decode_audio at 0x000001BF0F922E80>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpup2qtk5g.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpup2qtk5g.wav'
2025-04-18 20:31:42.451 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001BF08E6EC00>
    â”” <Thread(WorkerThread-1, started 15916)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001BF08E6E8E0>
    â”” <Thread(WorkerThread-1, started 15916)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 15916)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 15916)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF49436DD0>>
    â”” <Thread(WorkerThread-1, started 15916)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001BF0D5E7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF49436DD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001BF0D5E6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF48D34EE0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001BF0D5E7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001BF0AD6C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001BF49436900>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001BF48C7C480>
           â”‚      â”” <function Runner.run at 0x000001BF0AE27EC0>
           â”” <asyncio.runners.Runner object at 0x000001BF49171A10>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-75' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001BF0AE259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001BF49171A10>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001BF0AE25940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001BF0AE27740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001BF0AD6CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF48D34EE0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqa_jbjfc.wav'
                 â”” <function transcribe_audio at 0x000001BF26258EA0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqa_jbjfc.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001BF32679D00>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001BF26262C50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqa_jbjfc.wav'
            â”” <function decode_audio at 0x000001BF0F922E80>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqa_jbjfc.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpqa_jbjfc.wav'
2025-04-18 20:31:50.205 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001BF08E6EC00>
    â”” <Thread(WorkerThread-2, started 33228)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001BF08E6E8E0>
    â”” <Thread(WorkerThread-2, started 33228)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-2, started 33228)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-2, started 33228)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF493952D0>>
    â”” <Thread(WorkerThread-2, started 33228)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001BF0D5E7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF493952D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001BF0D5E6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF48D369E0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001BF0D5E7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001BF0AD6C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001BF4913F900>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001BF48F6ACE0>
           â”‚      â”” <function Runner.run at 0x000001BF0AE27EC0>
           â”” <asyncio.runners.Runner object at 0x000001BF4944F390>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-120' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001BF0AE259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001BF4944F390>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001BF0AE25940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001BF0AE27740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001BF0AD6CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF48D369E0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp4m387_bf.wav'
                 â”” <function transcribe_audio at 0x000001BF26258EA0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp4m387_bf.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001BF32679D00>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001BF26262C50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp4m387_bf.wav'
            â”” <function decode_audio at 0x000001BF0F922E80>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp4m387_bf.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp4m387_bf.wav'
2025-04-18 20:31:55.546 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001BF08E6EC00>
    â”” <Thread(WorkerThread-3, started 4608)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001BF08E6E8E0>
    â”” <Thread(WorkerThread-3, started 4608)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-3, started 4608)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-3, started 4608)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF48D32B10>>
    â”” <Thread(WorkerThread-3, started 4608)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001BF0D5E7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF48D32B10>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001BF0D5E6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF48C31240>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001BF0D5E7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001BF0AD6C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001BF48C97F40>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001BF48C7D580>
           â”‚      â”” <function Runner.run at 0x000001BF0AE27EC0>
           â”” <asyncio.runners.Runner object at 0x000001BF48C4F750>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-164' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001BF0AE259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001BF48C4F750>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001BF0AE25940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001BF0AE27740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001BF0AD6CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF48C31240>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmprzjy7cqc.wav'
                 â”” <function transcribe_audio at 0x000001BF26258EA0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmprzjy7cqc.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001BF32679D00>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001BF26262C50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmprzjy7cqc.wav'
            â”” <function decode_audio at 0x000001BF0F922E80>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmprzjy7cqc.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmprzjy7cqc.wav'
2025-04-18 20:33:47.477 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001BF08E6EC00>
    â”” <Thread(WorkerThread-4, started 25540)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001BF08E6E8E0>
    â”” <Thread(WorkerThread-4, started 25540)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-4, started 25540)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-4, started 25540)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF495C2F50>>
    â”” <Thread(WorkerThread-4, started 25540)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001BF0D5E7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001BF495C2F50>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001BF0D5E6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF0EA644C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001BF0D5E7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001BF0AD6C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001BF495CD280>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001BF48CD89D0>
           â”‚      â”” <function Runner.run at 0x000001BF0AE27EC0>
           â”” <asyncio.runners.Runner object at 0x000001BF48CA0210>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-209' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001BF0AE259E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001BF48CA0210>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001BF0AE25940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001BF0AE27740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001BF0AD6CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001BF0EA644C0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjw4lzfi7.wav'
                 â”” <function transcribe_audio at 0x000001BF26258EA0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjw4lzfi7.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001BF32679D00>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001BF26262C50>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjw4lzfi7.wav'
            â”” <function decode_audio at 0x000001BF0F922E80>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjw4lzfi7.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpjw4lzfi7.wav'
2025-04-18 20:33:58.144 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001A5959AEC00>
    â”” <Thread(WorkerThread-0, started 28412)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001A5959AE8E0>
    â”” <Thread(WorkerThread-0, started 28412)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 28412)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 28412)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A5D5BF51D0>>
    â”” <Thread(WorkerThread-0, started 28412)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001A59A197CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A5D5BF51D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001A59A196FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A5D586C3A0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001A59A197420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001A59791C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001A5D5C01000>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001A5D5ADE9B0>
           â”‚      â”” <function Runner.run at 0x000001A5979D7EC0>
           â”” <asyncio.runners.Runner object at 0x000001A5D5C13C50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001A5979D59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001A5D5C13C50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001A5979D5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001A5979D7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001A59791CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A5D586C3A0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp84pt7pm8.wav'
                 â”” <function transcribe_audio at 0x000001A5B2E08F40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp84pt7pm8.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001A5BF205DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001A59C056310>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp84pt7pm8.wav'
            â”” <function decode_audio at 0x000001A59C17F100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp84pt7pm8.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmp84pt7pm8.wav'
2025-04-18 20:34:03.306 | INFO     | app.services.summarization:get_summary_from_llm:10 - Summarizing user query: ...
2025-04-18 20:34:03.307 | INFO     | app.llm:get_summarization_response:42 - Summarizing content for query: 
2025-04-18 20:34:50.033 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001A5959AEC00>
    â”” <Thread(WorkerThread-2, started 36200)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001A5959AE8E0>
    â”” <Thread(WorkerThread-2, started 36200)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-2, started 36200)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-2, started 36200)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A5D5C03750>>
    â”” <Thread(WorkerThread-2, started 36200)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001A59A197CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A5D5C03750>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001A59A196FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A5D586F520>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001A59A197420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001A59791C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001A5D5C8F400>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001A5D5ADF780>
           â”‚      â”” <function Runner.run at 0x000001A5979D7EC0>
           â”” <asyncio.runners.Runner object at 0x000001A5D5C8EC50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-113' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001A5979D59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001A5D5C8EC50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001A5979D5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001A5979D7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001A59791CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A5D586F520>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpx3w2hb4d.wav'
                 â”” <function transcribe_audio at 0x000001A5B2E08F40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpx3w2hb4d.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001A5BF205DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001A59C056310>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpx3w2hb4d.wav'
            â”” <function decode_audio at 0x000001A59C17F100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpx3w2hb4d.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpx3w2hb4d.wav'
2025-04-18 20:35:01.075 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001A8CBE9EC00>
    â”” <Thread(WorkerThread-0, started 14036)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001A8CBE9E8E0>
    â”” <Thread(WorkerThread-0, started 14036)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 14036)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 14036)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A88C447C50>>
    â”” <Thread(WorkerThread-0, started 14036)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001A8D0617CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A88C447C50>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001A8D0616FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A88C1BD6C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001A8D0617420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001A8CDE1C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001A88C58C380>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001A88C43AAC0>
           â”‚      â”” <function Runner.run at 0x000001A8CDED7EC0>
           â”” <asyncio.runners.Runner object at 0x000001A88C580F90>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001A8CDED59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001A88C580F90>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001A8CDED5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001A8CDED7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001A8CDE1CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A88C1BD6C0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmplhgrzsri.wav'
                 â”” <function transcribe_audio at 0x000001A8E9298F40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmplhgrzsri.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001A8F5745DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001A8D24CA910>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmplhgrzsri.wav'
            â”” <function decode_audio at 0x000001A8D2953100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmplhgrzsri.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmplhgrzsri.wav'
2025-04-18 20:35:22.076 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001A8CBE9EC00>
    â”” <Thread(WorkerThread-1, started 33088)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001A8CBE9E8E0>
    â”” <Thread(WorkerThread-1, started 33088)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 33088)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 33088)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A88C8ECDD0>>
    â”” <Thread(WorkerThread-1, started 33088)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001A8D0617CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A88C8ECDD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001A8D0616FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A88C1BD6C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001A8D0617420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001A8CDE1C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001A88C921180>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001A88C439360>
           â”‚      â”” <function Runner.run at 0x000001A8CDED7EC0>
           â”” <asyncio.runners.Runner object at 0x000001A88C58C310>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-75' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001A8CDED59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001A88C58C310>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001A8CDED5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001A8CDED7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001A8CDE1CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A88C1BD6C0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpmqsnk02n.wav'
                 â”” <function transcribe_audio at 0x000001A8E9298F40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpmqsnk02n.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001A8F5745DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001A8D24CA910>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpmqsnk02n.wav'
            â”” <function decode_audio at 0x000001A8D2953100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpmqsnk02n.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpmqsnk02n.wav'
2025-04-18 20:35:30.890 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001A8CBE9EC00>
    â”” <Thread(WorkerThread-2, started 18312)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001A8CBE9E8E0>
    â”” <Thread(WorkerThread-2, started 18312)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-2, started 18312)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-2, started 18312)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A88C61C310>>
    â”” <Thread(WorkerThread-2, started 18312)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x000001A8D0617CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001A88C61C310>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x000001A8D0616FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A88C1BEF80>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x000001A8D0617420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x000001A8CDE1C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001A88C8C93C0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001A88C39FCD0>
           â”‚      â”” <function Runner.run at 0x000001A8CDED7EC0>
           â”” <asyncio.runners.Runner object at 0x000001A88C61EF50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-120' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000001A8CDED59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001A88C61EF50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000001A8CDED5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000001A8CDED7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000001A8CDE1CEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_audio_and_identify_speakers at 0x000001A88C1BEF80>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpggd9hplg.wav'
                 â”” <function transcribe_audio at 0x000001A8E9298F40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpggd9hplg.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x000001A8F5745DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x000001A8D24CA910>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpggd9hplg.wav'
            â”” <function decode_audio at 0x000001A8D2953100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpggd9hplg.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpggd9hplg.wav'
2025-04-18 20:36:48.153 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x0000024C2515EC00>
    â”” <Thread(WorkerThread-0, started 27248)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x0000024C2515E8E0>
    â”” <Thread(WorkerThread-0, started 27248)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-0, started 27248)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-0, started 27248)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x0000024C6551F7D0>>
    â”” <Thread(WorkerThread-0, started 27248)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x0000024C298F7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x0000024C6551F7D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x0000024C298F6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_and_identify_speakers_task at 0x0000024C6560A260>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x0000024C298F7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000024C26FFC360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x0000024C65650D00>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x0000024C6550ABD0>
           â”‚      â”” <function Runner.run at 0x0000024C27197EC0>
           â”” <asyncio.runners.Runner object at 0x0000024C65643810>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000024C271959E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x0000024C65643810>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000024C27195940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000024C27197740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000024C26FFCEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_and_identify_speakers_task at 0x0000024C6560A260>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 11, in transcribe_and_identify_speakers_task
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
                 â”” <function transcribe_audio_and_identify_speakers at 0x0000024C2BC32C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpwuaoshpu.wav'
                 â”” <function transcribe_audio at 0x0000024C4256CF40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpwuaoshpu.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x0000024C4ED09DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x0000024C2B7A7E10>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpwuaoshpu.wav'
            â”” <function decode_audio at 0x0000024C2BC33100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpwuaoshpu.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpwuaoshpu.wav'
2025-04-18 20:36:52.742 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x0000024C2515EC00>
    â”” <Thread(WorkerThread-1, started 36164)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x0000024C2515E8E0>
    â”” <Thread(WorkerThread-1, started 36164)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 36164)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 36164)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x0000024C65539D90>>
    â”” <Thread(WorkerThread-1, started 36164)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x0000024C298F7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x0000024C65539D90>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x0000024C298F6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_and_identify_speakers_task at 0x0000024C659C5490>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x0000024C298F7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000024C26FFC360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x0000024C659B4F80>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x0000024C657128A0>
           â”‚      â”” <function Runner.run at 0x0000024C27197EC0>
           â”” <asyncio.runners.Runner object at 0x0000024C65665450>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-74' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000024C271959E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x0000024C65665450>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000024C27195940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000024C27197740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000024C26FFCEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_and_identify_speakers_task at 0x0000024C659C5490>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 11, in transcribe_and_identify_speakers_task
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
                 â”” <function transcribe_audio_and_identify_speakers at 0x0000024C2BC32C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppq6d4l2u.wav'
                 â”” <function transcribe_audio at 0x0000024C4256CF40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppq6d4l2u.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x0000024C4ED09DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x0000024C2B7A7E10>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppq6d4l2u.wav'
            â”” <function decode_audio at 0x0000024C2BC33100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppq6d4l2u.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmppq6d4l2u.wav'
2025-04-18 20:37:17.710 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x0000024C2515EC00>
    â”” <Thread(WorkerThread-2, started 7032)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x0000024C2515E8E0>
    â”” <Thread(WorkerThread-2, started 7032)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-2, started 7032)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-2, started 7032)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x0000024C64D0C2D0>>
    â”” <Thread(WorkerThread-2, started 7032)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x0000024C298F7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x0000024C64D0C2D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x0000024C298F6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_and_identify_speakers_task at 0x0000024C65719080>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x0000024C298F7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000024C26FFC360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x0000024C65935C00>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x0000024C6515A9B0>
           â”‚      â”” <function Runner.run at 0x0000024C27197EC0>
           â”” <asyncio.runners.Runner object at 0x0000024C659E0250>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-119' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000024C271959E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x0000024C659E0250>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000024C27195940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000024C27197740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000024C26FFCEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_and_identify_speakers_task at 0x0000024C65719080>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 11, in transcribe_and_identify_speakers_task
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='improved_customer_service_call.wav', size=8876108, headers=Headers({'content-disposition': 'form-data; n...
                 â”” <function transcribe_audio_and_identify_speakers at 0x0000024C2BC32C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpkqmob1s5.wav'
                 â”” <function transcribe_audio at 0x0000024C4256CF40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpkqmob1s5.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x0000024C4ED09DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x0000024C2B7A7E10>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpkqmob1s5.wav'
            â”” <function decode_audio at 0x0000024C2BC33100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpkqmob1s5.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpkqmob1s5.wav'
2025-04-18 20:40:01.593 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x0000024C2515EC00>
    â”” <Thread(WorkerThread-3, started 7556)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x0000024C2515E8E0>
    â”” <Thread(WorkerThread-3, started 7556)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-3, started 7556)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-3, started 7556)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x0000024C656E0F10>>
    â”” <Thread(WorkerThread-3, started 7556)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x0000024C298F7CE0>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x0000024C656E0F10>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x0000024C298F6FC0>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_and_identify_speakers_task at 0x0000024C65239FF0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x0000024C298F7420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000024C26FFC360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x0000024C65245300>
           â”” transcribe_and_identify_speakers_task(UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'...
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x0000024C2C04A9B0>
           â”‚      â”” <function Runner.run at 0x0000024C27197EC0>
           â”” <asyncio.runners.Runner object at 0x0000024C65657710>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-164' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000024C271959E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x0000024C65657710>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000024C27195940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000024C27197740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000024C26FFCEA0>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finis...\x00\x00\x00'>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_and_identify_speakers_task at 0x0000024C65239FF0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 11, in transcribe_and_identify_speakers_task
    return await transcribe_audio_and_identify_speakers(file)
                 â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
                 â”” <function transcribe_audio_and_identify_speakers at 0x0000024C2BC32C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 19, in transcribe_audio_and_identify_speakers
    transcript = transcribe_audio(temp_file_path)
                 â”‚                â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpj3mofvri.wav'
                 â”” <function transcribe_audio at 0x0000024C4256CF40>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\speaker_id.py", line 14, in transcribe_audio
    segments, _ = whisper_model.transcribe(file_path)
                  â”‚             â”‚          â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpj3mofvri.wav'
                  â”‚             â”” <function WhisperModel.transcribe at 0x0000024C4ED09DA0>
                  â”” <faster_whisper.transcribe.WhisperModel object at 0x0000024C2B7A7E10>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\transcribe.py", line 834, in transcribe
    audio = decode_audio(audio, sampling_rate=sampling_rate)
            â”‚            â”‚                    â”” 16000
            â”‚            â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpj3mofvri.wav'
            â”” <function decode_audio at 0x0000024C2BC33100>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\faster_whisper\audio.py", line 46, in decode_audio
    with av.open(input_file, mode="r", metadata_errors="ignore") as container:
         â”‚  â”‚    â”” 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpj3mofvri.wav'
         â”‚  â”” <built-in function open>
         â”” <module 'av' from 'C:\\Users\\Abhi\\Desktop\\mlops\\mlops4\\customer_service_assistant\\cs_assist\\Lib\\site-packages\\av\\__...
  File "av/container/core.pyx", line 418, in av.container.core.open
    return InputContainer(_cinit_sentinel, file, format, options,
  File "av/container/core.pyx", line 283, in av.container.core.Container.__cinit__
    self.err_check(res)
  File "av/container/core.pyx", line 303, in av.container.core.Container.err_check
    return err_check(value, filename=self.name)
  File "av/error.pyx", line 424, in av.error.err_check
    raise cls(code, message, filename, log)
          â”‚   â”” 1447131472
          â”” <class 'av.error.PyAVCallbackError'>

av.error.InvalidDataError: [Errno 1094995529] Invalid data found when processing input: 'C:\\Users\\Abhi\\AppData\\Local\\Temp\\tmpj3mofvri.wav'
2025-04-18 20:40:30.259 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:23 - Failed to load WAV file: [WinError 2] The system cannot find the file specified
2025-04-18 20:41:56.469 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:23 - Failed to load WAV file: [WinError 2] The system cannot find the file specified
2025-04-18 20:42:31.344 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:23 - Failed to load WAV file: [WinError 2] The system cannot find the file specified
2025-04-18 20:43:16.046 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:23 - Failed to load WAV file: [WinError 2] The system cannot find the file specified
2025-04-18 20:44:55.069 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\spawn.py", line 120, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â”‚     â”‚   â”” 332
               â”‚     â”” 3
               â”” <function _main at 0x000002A37F41B9C0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\spawn.py", line 133, in _main
    return self._bootstrap(parent_sentinel)
           â”‚    â”‚          â”” 332
           â”‚    â”” <function BaseProcess._bootstrap at 0x000002A37F331A80>
           â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    â”‚    â”” <function BaseProcess.run at 0x000002A37F330FE0>
    â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {'config': <uvicorn.config.Config object at 0x000002A37F3E3390>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â”‚    â”‚        â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
    â”‚    â”” <function subprocess_started at 0x000002A3018C07C0>
    â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â”‚              â”” [<socket.socket fd=396, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â”” <bound method Server.run of <uvicorn.server.Server object at 0x000002A3018F0090>>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â”‚       â”‚   â”‚    â”‚             â”” [<socket.socket fd=396, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â”‚       â”‚   â”‚    â”” <function Server.serve at 0x000002A30189B6A0>
           â”‚       â”‚   â”” <uvicorn.server.Server object at 0x000002A3018F0090>
           â”‚       â”” <function run at 0x000002A37FBBC360>
           â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Server.serve at 0x000002A30186F100>
           â”‚      â”” <function Runner.run at 0x000002A37FCB7EC0>
           â”” <asyncio.runners.Runner object at 0x000002A37FD84ED0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000002A37FCB59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000002A37FD84ED0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000002A37FCB5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000002A37FCB7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000002A37FBBCEA0>
    â”” <Handle Task.task_wakeup(<Future finished result=0>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finished result=0>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finished result=0>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finished result=0>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002A3018F3AD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â”‚    â”‚   â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49E90>>
                 â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
                 â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 â”‚    â”” <fastapi.applications.FastAPI object at 0x000002A3051879D0>
                 â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002A3018F3AD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49E90>>
                           â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
                           â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49E90>>
          â”‚    â”‚                â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚    â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002A30507A950>
          â”” <fastapi.applications.FastAPI object at 0x000002A3051879D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          â”‚    â”‚   â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002A3018E20C0>
          â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚    â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002A305079FD0>
          â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002A30507A950>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002A3018E20C0>
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚                            â”‚    â”‚    â”‚     â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚                            â”‚    â”‚    â”” <starlette.requests.Request object at 0x000002A306014790>
          â”‚                            â”‚    â”” <fastapi.routing.APIRouter object at 0x000002A306024D10>
          â”‚                            â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002A305079FD0>
          â”” <function wrap_app_handling_exceptions at 0x000002A301FB9580>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A306037F60>
          â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”” <fastapi.routing.APIRouter object at 0x000002A306024D10>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A306037F60>
          â”‚    â”‚                â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚    â”” <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002A306024D10>>
          â”” <fastapi.routing.APIRouter object at 0x000002A306024D10>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
          â”‚     â”‚      â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A306037F60>
          â”‚     â”‚      â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚     â”‚      â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚     â”” <function Route.handle at 0x000002A301FBAB60>
          â”” APIRoute(path='/transcribe-audio', name='transcribe_audio', methods=['POST'])
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A306037F60>
          â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚    â”” <function request_response.<locals>.app at 0x000002A306037880>
          â”” APIRoute(path='/transcribe-audio', name='transcribe_audio', methods=['POST'])
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          â”‚                            â”‚    â”‚        â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A306037F60>
          â”‚                            â”‚    â”‚        â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚                            â”‚    â”‚        â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚                            â”‚    â”” <starlette.requests.Request object at 0x000002A306027E90>
          â”‚                            â”” <function request_response.<locals>.app.<locals>.app at 0x000002A304D50040>
          â”” <function wrap_app_handling_exceptions at 0x000002A301FB9580>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A304D50180>
          â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”” <function request_response.<locals>.app.<locals>.app at 0x000002A304D50040>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     â”‚ â”” <starlette.requests.Request object at 0x000002A306027E90>
                     â”” <function get_request_handler.<locals>.app at 0x000002A306037920>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         â”” <function run_endpoint_function at 0x000002A301FDC9A0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 â”‚         â”‚      â”” {'file': UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-d...
                 â”‚         â”” <function transcribe_audio at 0x000002A3060377E0>
                 â”” Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(name='file', type=Uplo...

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\api\endpoints.py", line 108, in transcribe_audio
    result =  transcribe_audio_and_identify_speakers(file)
              â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
              â”” <function transcribe_audio_and_identify_speakers at 0x000002A305C02C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 15, in transcribe_audio_and_identify_speakers
    temp_file.write(contents)
    â”‚         â”‚     â”” <coroutine object UploadFile.read at 0x000002A301AB8820>
    â”‚         â”” <function BufferedRandom.write at 0x000002A304D502C0>
    â”” <tempfile._TemporaryFileWrapper object at 0x000002A306014490>

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\tempfile.py", line 483, in func_wrapper
    return func(*args, **kwargs)
           â”‚     â”‚       â”” {}
           â”‚     â”” (<coroutine object UploadFile.read at 0x000002A301AB8820>,)
           â”” <built-in method write of _io.BufferedRandom object at 0x000002A306031590>

TypeError: a bytes-like object is required, not 'coroutine'
2025-04-18 20:45:14.698 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:44 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\spawn.py", line 120, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â”‚     â”‚   â”” 332
               â”‚     â”” 3
               â”” <function _main at 0x000002A37F41B9C0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\spawn.py", line 133, in _main
    return self._bootstrap(parent_sentinel)
           â”‚    â”‚          â”” 332
           â”‚    â”” <function BaseProcess._bootstrap at 0x000002A37F331A80>
           â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    â”‚    â”” <function BaseProcess.run at 0x000002A37F330FE0>
    â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {'config': <uvicorn.config.Config object at 0x000002A37F3E3390>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â”‚    â”‚        â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
    â”‚    â”” <function subprocess_started at 0x000002A3018C07C0>
    â”” <SpawnProcess name='SpawnProcess-2' parent=3828 started>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â”‚              â”” [<socket.socket fd=396, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â”” <bound method Server.run of <uvicorn.server.Server object at 0x000002A3018F0090>>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â”‚       â”‚   â”‚    â”‚             â”” [<socket.socket fd=396, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â”‚       â”‚   â”‚    â”” <function Server.serve at 0x000002A30189B6A0>
           â”‚       â”‚   â”” <uvicorn.server.Server object at 0x000002A3018F0090>
           â”‚       â”” <function run at 0x000002A37FBBC360>
           â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Server.serve at 0x000002A30186F100>
           â”‚      â”” <function Runner.run at 0x000002A37FCB7EC0>
           â”” <asyncio.runners.Runner object at 0x000002A37FD84ED0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x000002A37FCB59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000002A37FD84ED0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x000002A37FCB5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x000002A37FCB7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x000002A37FBBCEA0>
    â”” <Handle Task.task_wakeup(<Future finished result=0>)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle Task.task_wakeup(<Future finished result=0>)>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle Task.task_wakeup(<Future finished result=0>)>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle Task.task_wakeup(<Future finished result=0>)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002A3018F3AD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â”‚    â”‚   â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49210>>
                 â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
                 â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 â”‚    â”” <fastapi.applications.FastAPI object at 0x000002A3051879D0>
                 â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002A3018F3AD0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49210>>
                           â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
                           â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49210>>
          â”‚    â”‚                â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚    â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002A30507A950>
          â”” <fastapi.applications.FastAPI object at 0x000002A3051879D0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          â”‚    â”‚   â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002A30604B560>
          â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚    â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002A305079FD0>
          â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002A30507A950>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002A30604B560>
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚                            â”‚    â”‚    â”‚     â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚                            â”‚    â”‚    â”” <starlette.requests.Request object at 0x000002A3282F0C50>
          â”‚                            â”‚    â”” <fastapi.routing.APIRouter object at 0x000002A306024D10>
          â”‚                            â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002A305079FD0>
          â”” <function wrap_app_handling_exceptions at 0x000002A301FB9580>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A304D50040>
          â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”” <fastapi.routing.APIRouter object at 0x000002A306024D10>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A304D50040>
          â”‚    â”‚                â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚    â”” <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002A306024D10>>
          â”” <fastapi.routing.APIRouter object at 0x000002A306024D10>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 734, in app
    await route.handle(scope, receive, send)
          â”‚     â”‚      â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A304D50040>
          â”‚     â”‚      â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚     â”‚      â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚     â”” <function Route.handle at 0x000002A301FBAB60>
          â”” APIRoute(path='/transcribe-audio', name='transcribe_audio', methods=['POST'])
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A304D50040>
          â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚    â”” <function request_response.<locals>.app at 0x000002A306037880>
          â”” APIRoute(path='/transcribe-audio', name='transcribe_audio', methods=['POST'])
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          â”‚                            â”‚    â”‚        â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A304D50040>
          â”‚                            â”‚    â”‚        â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚                            â”‚    â”‚        â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”‚                            â”‚    â”” <starlette.requests.Request object at 0x000002A305184750>
          â”‚                            â”” <function request_response.<locals>.app.<locals>.app at 0x000002A304D50180>
          â”” <function wrap_app_handling_exceptions at 0x000002A301FB9580>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002A3060362A0>
          â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002A304D49...
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          â”” <function request_response.<locals>.app.<locals>.app at 0x000002A304D50180>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     â”‚ â”” <starlette.requests.Request object at 0x000002A305184750>
                     â”” <function get_request_handler.<locals>.app at 0x000002A306037920>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         â”” <function run_endpoint_function at 0x000002A301FDC9A0>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 â”‚         â”‚      â”” {'file': UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-d...
                 â”‚         â”” <function transcribe_audio at 0x000002A3060377E0>
                 â”” Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(name='file', type=Uplo...

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\api\endpoints.py", line 108, in transcribe_audio
    result =  transcribe_audio_and_identify_speakers(file)
              â”‚                                      â”” UploadFile(filename='customer_service_call_fixed.wav', size=3418622, headers=Headers({'content-disposition': 'form-data; name...
              â”” <function transcribe_audio_and_identify_speakers at 0x000002A305C02C00>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 15, in transcribe_audio_and_identify_speakers
    temp_file.write(contents)
    â”‚         â”‚     â”” <coroutine object UploadFile.read at 0x000002A3239402E0>
    â”‚         â”” <function BufferedRandom.write at 0x000002A306037CE0>
    â”” <tempfile._TemporaryFileWrapper object at 0x000002A3315F6CD0>

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\tempfile.py", line 483, in func_wrapper
    return func(*args, **kwargs)
           â”‚     â”‚       â”” {}
           â”‚     â”” (<coroutine object UploadFile.read at 0x000002A3239402E0>,)
           â”” <built-in method write of _io.BufferedRandom object at 0x000002A3315C4880>

TypeError: a bytes-like object is required, not 'coroutine'
2025-04-18 20:46:33.650 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:31 - Aligned Transcript with Roles: [{'speaker': 'Customer', 'text': 'Hello. I need help with my recent order.', 'start': 0.0, 'end': 3.0}, {'speaker': 'Agent', 'text': 'Sure. Can you provide me with your order number?', 'start': 5.0, 'end': 8.0}, {'speaker': 'Customer', 'text': "Yes. It's 12,345.", 'start': 10.0, 'end': 13.0}, {'speaker': 'Customer', 'text': 'Thank you. What issue are you facing?', 'start': 15.0, 'end': 18.0}, {'speaker': 'Customer', 'text': 'I received the wrong item and would like to return it.', 'start': 20.0, 'end': 23.0}, {'speaker': 'Customer', 'text': 'I understand. I will initiate a return request for you.', 'start': 25.0, 'end': 29.0}, {'speaker': 'Customer', 'text': 'Great. Thanks.', 'start': 31.0, 'end': 33.0}, {'speaker': 'Customer', 'text': "You're welcome. Have a great day.", 'start': 34.0, 'end': 37.0}]
2025-04-18 20:50:11.047 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:31 - Aligned Transcript with Roles: [{'speaker': 'Customer', 'text': 'Hello. I need help with my recent order.', 'start': 0.0, 'end': 3.0}, {'speaker': 'Agent', 'text': 'Sure. Can you provide me with your order number?', 'start': 5.0, 'end': 8.0}, {'speaker': 'Customer', 'text': "Yes. It's 12,345.", 'start': 10.0, 'end': 13.0}, {'speaker': 'Customer', 'text': 'Thank you. What issue are you facing?', 'start': 15.0, 'end': 18.0}, {'speaker': 'Customer', 'text': 'I received the wrong item and would like to return it.', 'start': 20.0, 'end': 23.0}, {'speaker': 'Customer', 'text': 'I understand. I will initiate a return request for you.', 'start': 25.0, 'end': 29.0}, {'speaker': 'Customer', 'text': 'Great. Thanks.', 'start': 31.0, 'end': 33.0}, {'speaker': 'Customer', 'text': "You're welcome. Have a great day.", 'start': 34.0, 'end': 37.0}]
2025-04-18 21:54:58.866 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:21 - Aligned Transcript with Roles: [{'speaker': 'Customer', 'text': 'Hello. I need help with my recent order.', 'start': 0.0, 'end': 3.0}, {'speaker': 'Agent', 'text': 'Sure. Can you provide me with your order number?', 'start': 5.0, 'end': 8.0}, {'speaker': 'Customer', 'text': "Yes. It's 12,345.", 'start': 10.0, 'end': 13.0}, {'speaker': 'Customer', 'text': 'Thank you. What issue are you facing?', 'start': 15.0, 'end': 18.0}, {'speaker': 'Customer', 'text': 'I received the wrong item and would like to return it.', 'start': 20.0, 'end': 23.0}, {'speaker': 'Customer', 'text': 'I understand. I will initiate a return request for you.', 'start': 25.0, 'end': 29.0}, {'speaker': 'Customer', 'text': 'Great. Thanks.', 'start': 31.0, 'end': 33.0}, {'speaker': 'Customer', 'text': "You're welcome. Have a great day.", 'start': 34.0, 'end': 37.0}]
2025-04-18 21:55:28.634 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:21 - Aligned Transcript with Roles: [{'speaker': 'Customer', 'text': 'Hello. I need help with my recent order.', 'start': 0.0, 'end': 3.0}, {'speaker': 'Agent', 'text': 'Sure. Can you provide me with your order number?', 'start': 5.0, 'end': 8.0}, {'speaker': 'Customer', 'text': "Yes. It's 12,345.", 'start': 10.0, 'end': 13.0}, {'speaker': 'Customer', 'text': 'Thank you. What issue are you facing?', 'start': 15.0, 'end': 18.0}, {'speaker': 'Customer', 'text': 'I received the wrong item and would like to return it.', 'start': 20.0, 'end': 23.0}, {'speaker': 'Customer', 'text': 'I understand. I will initiate a return request for you.', 'start': 25.0, 'end': 29.0}, {'speaker': 'Customer', 'text': 'Great. Thanks.', 'start': 31.0, 'end': 33.0}, {'speaker': 'Customer', 'text': "You're welcome. Have a great day.", 'start': 34.0, 'end': 37.0}]
2025-04-18 21:56:09.034 | INFO     | app.services.summarization:get_summary_from_llm:10 - Summarizing user query: Customer: Hello. I need help with my recent order....
2025-04-18 21:56:09.034 | INFO     | app.llm:get_summarization_response:42 - Summarizing content for query: Customer: Hello. I need help with my recent order.
Agent: Sure. Can you provide me with your order number?
Customer: Yes. It's 12,345.
Customer: Thank you. What issue are you facing?
Customer: I received the wrong item and would like to return it.
Customer: I understand. I will initiate a return request for you.
Customer: Great. Thanks.
Customer: You're welcome. Have a great day.

2025-04-18 21:58:37.501 | INFO     | app.services.intent:get_intent_from_llm:10 - Getting intent for query: Customer: Hello. I need help with my recent order....
2025-04-18 21:58:37.501 | INFO     | app.llm:get_intent_response:47 - Determining intent for query: Customer: Hello. I need help with my recent order.
Agent: Sure. Can you provide me with your order number?
Customer: Yes. It's 12,345.
Customer: Thank you. What issue are you facing?
Customer: I received the wrong item and would like to return it.
Customer: I understand. I will initiate a return request for you.
Customer: Great. Thanks.
Customer: You're welcome. Have a great day.

2025-04-18 21:59:46.681 | INFO     | app.services.sentiment:analyze_sentiment:10 - Analyzing sentiment for query: Customer: Hello. I need help with my recent order....
2025-04-18 21:59:46.681 | INFO     | app.llm:get_sentiment_response:32 - Getting sentiment for query: Analyze the sentiment of the following text: Customer: Hello. I need help with my recent order.
Agent: Sure. Can you provide me with your order number?
Customer: Yes. It's 12,345.
Customer: Thank you. What issue are you facing?
Customer: I received the wrong item and would like to return it.
Customer: I understand. I will initiate a return request for you.
Customer: Great. Thanks.
Customer: You're welcome. Have a great day.

2025-04-18 22:04:10.600 | INFO     | app.services.solution:suggest_solution:7 - Suggesting solution for query: Customer: Hello. I need help with my recent order....
2025-04-18 22:13:13.182 | INFO     | app.services.response_template:suggest_response_template:7 - Suggesting response template for query: Customer: Hello. I need help with my recent order....
2025-04-18 22:16:15.192 | INFO     | app.services.categorization:categorize:7 - Categorizing conversation...
2025-04-18 22:19:41.130 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:21 - Aligned Transcript with Roles: [{'speaker': 'Customer', 'text': 'Hello. I need help with my recent order.', 'start': 0.0, 'end': 3.0}, {'speaker': 'Agent', 'text': 'Sure. Can you provide me with your order number?', 'start': 5.0, 'end': 8.0}, {'speaker': 'Customer', 'text': "Yes. It's 12,345.", 'start': 10.0, 'end': 13.0}, {'speaker': 'Customer', 'text': 'Thank you. What issue are you facing?', 'start': 15.0, 'end': 18.0}, {'speaker': 'Customer', 'text': 'I received the wrong item and would like to return it.', 'start': 20.0, 'end': 23.0}, {'speaker': 'Customer', 'text': 'I understand. I will initiate a return request for you.', 'start': 25.0, 'end': 29.0}, {'speaker': 'Customer', 'text': 'Great. Thanks.', 'start': 31.0, 'end': 33.0}, {'speaker': 'Customer', 'text': "You're welcome. Have a great day.", 'start': 34.0, 'end': 37.0}]
2025-04-18 22:29:02.093 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:21 - Aligned Transcript with Roles: [{'speaker': 'Customer', 'text': 'Hello. I need help with my recent order.', 'start': 0.0, 'end': 3.0}, {'speaker': 'Agent', 'text': 'Sure. Can you provide me with your order number?', 'start': 5.0, 'end': 8.0}, {'speaker': 'Customer', 'text': "Yes. It's 12,345.", 'start': 10.0, 'end': 13.0}, {'speaker': 'Customer', 'text': 'Thank you. What issue are you facing?', 'start': 15.0, 'end': 18.0}, {'speaker': 'Customer', 'text': 'I received the wrong item and would like to return it.', 'start': 20.0, 'end': 23.0}, {'speaker': 'Customer', 'text': 'I understand. I will initiate a return request for you.', 'start': 25.0, 'end': 29.0}, {'speaker': 'Customer', 'text': 'Great. Thanks.', 'start': 31.0, 'end': 33.0}, {'speaker': 'Customer', 'text': "You're welcome. Have a great day.", 'start': 34.0, 'end': 37.0}]
2025-04-18 22:58:26.650 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:60 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x00000289CF08EC00>
    â”” <Thread(WorkerThread-1, started 33588)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x00000289CF08E8E0>
    â”” <Thread(WorkerThread-1, started 33588)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 33588)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 33588)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x00000289ABF2D450>>
    â”” <Thread(WorkerThread-1, started 33588)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000289D37C7D80>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x00000289ABF2D450>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000289D37C7060>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_text at 0x00000289ABE8B920>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000289D37C74C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x00000289D0FEC360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x00000289ABF10400>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x00000289ABDEA130>
           â”‚      â”” <function Runner.run at 0x00000289D10A7EC0>
           â”” <asyncio.runners.Runner object at 0x00000289ABEB6310>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x00000289D10A59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x00000289ABEB6310>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x00000289D10A5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x00000289D10A7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x00000289D0FECEA0>
    â”” <Handle <TaskStepMethWrapper object at 0x00000289ABEF1D80>()>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle <TaskStepMethWrapper object at 0x00000289ABEF1D80>()>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle <TaskStepMethWrapper object at 0x00000289ABEF1D80>()>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle <TaskStepMethWrapper object at 0x00000289ABEF1D80>()>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_text at 0x00000289ABE8B920>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 9, in transcribe_text
    return await transcribe_audio_and_identify_speakers(file_bytes, filename)
                 â”‚                                      â”‚           â”” 'customer_service_call_fixed.wav'
                 â”‚                                      â”” b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LIST\x1a\x00\x00\x00INFOISF...
                 â”” <function transcribe_audio_and_identify_speakers at 0x00000289D5B06CA0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 15, in transcribe_audio_and_identify_speakers
    start_time = time.time()
                 â”” <built-in function time>

AttributeError: 'builtin_function_or_method' object has no attribute 'time'
2025-04-18 23:00:23.396 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:60 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x00000177B560EC00>
    â”” <Thread(WorkerThread-1, started 35196)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x00000177B560E8E0>
    â”” <Thread(WorkerThread-1, started 35196)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 35196)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 35196)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x0000017790F1C110>>
    â”” <Thread(WorkerThread-1, started 35196)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000177B9D97D80>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x0000017790F1C110>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000177B9D97060>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_text at 0x0000017790E8FD80>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000177B9D974C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x00000177B74CC360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x0000017790F115C0>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x0000017790DEA130>
           â”‚      â”” <function Runner.run at 0x00000177B7587EC0>
           â”” <asyncio.runners.Runner object at 0x0000017790F07890>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x00000177B75859E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x0000017790F07890>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x00000177B7585940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x00000177B7587740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x00000177B74CCEA0>
    â”” <Handle <TaskStepMethWrapper object at 0x0000017790EF1E10>()>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle <TaskStepMethWrapper object at 0x0000017790EF1E10>()>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle <TaskStepMethWrapper object at 0x0000017790EF1E10>()>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle <TaskStepMethWrapper object at 0x0000017790EF1E10>()>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_text at 0x0000017790E8FD80>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 9, in transcribe_text
    return await transcribe_audio_and_identify_speakers(file_bytes, filename)
                 â”‚                                      â”‚           â”” 'customer_service_call_fixed.wav'
                 â”‚                                      â”” b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LIST\x1a\x00\x00\x00INFOISF...
                 â”” <function transcribe_audio_and_identify_speakers at 0x00000177BC0D6CA0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 15, in transcribe_audio_and_identify_speakers
    start_time = time.time()
                 â”” <built-in function time>

AttributeError: 'builtin_function_or_method' object has no attribute 'time'
2025-04-18 23:01:19.580 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:60 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001871300EC00>
    â”” <Thread(WorkerThread-1, started 36832)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001871300E8E0>
    â”” <Thread(WorkerThread-1, started 36832)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 36832)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 36832)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001876E5F0750>>
    â”” <Thread(WorkerThread-1, started 36832)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000187177F7D80>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001876E5F0750>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000187177F7060>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_text at 0x000001876E5DCF20>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000187177F74C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000018714F3C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001876E5EE800>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001876E507670>
           â”‚      â”” <function Runner.run at 0x0000018714FF7EC0>
           â”” <asyncio.runners.Runner object at 0x000001876E53DE50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000018714FF59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001876E53DE50>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000018714FF5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000018714FF7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000018714F3CEA0>
    â”” <Handle <TaskStepMethWrapper object at 0x000001876E6290C0>()>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle <TaskStepMethWrapper object at 0x000001876E6290C0>()>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle <TaskStepMethWrapper object at 0x000001876E6290C0>()>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle <TaskStepMethWrapper object at 0x000001876E6290C0>()>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_text at 0x000001876E5DCF20>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 9, in transcribe_text
    return await transcribe_audio_and_identify_speakers(file_bytes, filename)
                 â”‚                                      â”‚           â”” 'customer_service_call_fixed.wav'
                 â”‚                                      â”” b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LIST\x1a\x00\x00\x00INFOISF...
                 â”” <function transcribe_audio_and_identify_speakers at 0x00000187197DACA0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 15, in transcribe_audio_and_identify_speakers
    start_time = time.time()
                 â”” <built-in function time>

AttributeError: 'builtin_function_or_method' object has no attribute 'time'
2025-04-18 23:01:55.452 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:60 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x000001871300EC00>
    â”” <Thread(WorkerThread-2, started 14484)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x000001871300E8E0>
    â”” <Thread(WorkerThread-2, started 14484)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-2, started 14484)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-2, started 14484)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x000001876EC7FE10>>
    â”” <Thread(WorkerThread-2, started 14484)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000187177F7D80>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x000001876EC7FE10>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000187177F7060>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_text at 0x000001876EC352A0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000187177F74C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000018714F3C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x000001876EC4F100>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x000001876E83CD00>
           â”‚      â”” <function Runner.run at 0x0000018714FF7EC0>
           â”” <asyncio.runners.Runner object at 0x000001876EC335D0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-74' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000018714FF59E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x000001876EC335D0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000018714FF5940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000018714FF7740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000018714F3CEA0>
    â”” <Handle <TaskStepMethWrapper object at 0x000001876EC6D060>()>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle <TaskStepMethWrapper object at 0x000001876EC6D060>()>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle <TaskStepMethWrapper object at 0x000001876EC6D060>()>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle <TaskStepMethWrapper object at 0x000001876EC6D060>()>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_text at 0x000001876EC352A0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 9, in transcribe_text
    return await transcribe_audio_and_identify_speakers(file_bytes, filename)
                 â”‚                                      â”‚           â”” 'customer_service_call_fixed.wav'
                 â”‚                                      â”” b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LIST\x1a\x00\x00\x00INFOISF...
                 â”” <function transcribe_audio_and_identify_speakers at 0x00000187197DACA0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 15, in transcribe_audio_and_identify_speakers
    start_time = time.time()
                 â”” <built-in function time>

AttributeError: 'builtin_function_or_method' object has no attribute 'time'
2025-04-18 23:06:47.472 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:60 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x00000250CF0AEC00>
    â”” <Thread(WorkerThread-1, started 23256)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x00000250CF0AE8E0>
    â”” <Thread(WorkerThread-1, started 23256)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 23256)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 23256)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x00000250B0683E10>>
    â”” <Thread(WorkerThread-1, started 23256)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x00000250D3827D80>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x00000250B0683E10>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x00000250D3827060>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_text at 0x00000250B062CBA0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x00000250D38274C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x00000250D0F3C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x00000250B05BB040>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x00000250B0576350>
           â”‚      â”” <function Runner.run at 0x00000250D1077EC0>
           â”” <asyncio.runners.Runner object at 0x00000250B063B390>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x00000250D10759E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x00000250B063B390>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x00000250D1075940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x00000250D1077740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x00000250D0F3CEA0>
    â”” <Handle <TaskStepMethWrapper object at 0x00000250B0671E40>()>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle <TaskStepMethWrapper object at 0x00000250B0671E40>()>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle <TaskStepMethWrapper object at 0x00000250B0671E40>()>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle <TaskStepMethWrapper object at 0x00000250B0671E40>()>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_text at 0x00000250B062CBA0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 9, in transcribe_text
    return await transcribe_audio_and_identify_speakers(file_bytes, filename)
                 â”‚                                      â”‚           â”” 'customer_service_call_fixed.wav'
                 â”‚                                      â”” b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LIST\x1a\x00\x00\x00INFOISF...
                 â”” <function transcribe_audio_and_identify_speakers at 0x00000250D580ECA0>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 15, in transcribe_audio_and_identify_speakers
    start_time = time.time()
                 â”” <built-in function time>

AttributeError: 'builtin_function_or_method' object has no attribute 'time'
2025-04-18 23:07:55.580 | INFO     | app.services.transcription:transcribe_audio_and_identify_speakers:22 - Aligned Transcript with Roles: [{'speaker': 'Customer', 'text': 'Hello. I need help with my recent order.', 'start': 0.0, 'end': 3.0}, {'speaker': 'Agent', 'text': 'Sure. Can you provide me with your order number?', 'start': 5.0, 'end': 8.0}, {'speaker': 'Customer', 'text': "Yes. It's 12,345.", 'start': 10.0, 'end': 13.0}, {'speaker': 'Customer', 'text': 'Thank you. What issue are you facing?', 'start': 15.0, 'end': 18.0}, {'speaker': 'Customer', 'text': 'I received the wrong item and would like to return it.', 'start': 20.0, 'end': 23.0}, {'speaker': 'Customer', 'text': 'I understand. I will initiate a return request for you.', 'start': 25.0, 'end': 29.0}, {'speaker': 'Customer', 'text': 'Great. Thanks.', 'start': 31.0, 'end': 33.0}, {'speaker': 'Customer', 'text': "You're welcome. Have a great day.", 'start': 34.0, 'end': 37.0}]
2025-04-18 23:16:26.506 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:57 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x0000019AAEC9EC00>
    â”” <Thread(WorkerThread-1, started 19872)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x0000019AAEC9E8E0>
    â”” <Thread(WorkerThread-1, started 19872)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-1, started 19872)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-1, started 19872)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x0000019A8A2DC090>>
    â”” <Thread(WorkerThread-1, started 19872)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x0000019AB33D7D80>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x0000019A8A2DC090>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x0000019AB33D7060>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_text at 0x0000019A8A331000>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x0000019AB33D74C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000019AB0B9C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x0000019A8A378F00>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x0000019A8A23F010>
           â”‚      â”” <function Runner.run at 0x0000019AB0C57EC0>
           â”” <asyncio.runners.Runner object at 0x0000019A8A36A710>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-30' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000019AB0C559E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x0000019A8A36A710>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000019AB0C55940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000019AB0C57740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000019AB0B9CEA0>
    â”” <Handle <TaskStepMethWrapper object at 0x0000019A8A34EFB0>()>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle <TaskStepMethWrapper object at 0x0000019A8A34EFB0>()>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle <TaskStepMethWrapper object at 0x0000019A8A34EFB0>()>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle <TaskStepMethWrapper object at 0x0000019A8A34EFB0>()>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_text at 0x0000019A8A331000>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 9, in transcribe_text
    return await transcribe_audio_and_identify_speakers(file_bytes, filename)
                 â”‚                                      â”‚           â”” 'customer_service_call_fixed.wav'
                 â”‚                                      â”” b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LIST\x1a\x00\x00\x00INFOISF...
                 â”” <function transcribe_audio_and_identify_speakers at 0x0000019AB5B27F60>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 41, in transcribe_audio_and_identify_speakers
    log_artifact_text("raw_transcript.txt", transcript)
    â”‚                                       â”” [{'start': 0.0, 'end': 3.0, 'text': 'Hello. I need help with my recent order.'}, {'start': 5.0, 'end': 8.0, 'text': 'Sure. Ca...
    â”” <function log_artifact_text at 0x0000019AD86F53A0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\utils\mlflow_logger.py", line 20, in log_artifact_text
    with open(filepath, "w", encoding="utf-8") as f:
              â”” '/tmp/raw_transcript.txt'

FileNotFoundError: [Errno 2] No such file or directory: '/tmp/raw_transcript.txt'
2025-04-18 23:20:21.450 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:57 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x0000019AAEC9EC00>
    â”” <Thread(WorkerThread-2, started 30956)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x0000019AAEC9E8E0>
    â”” <Thread(WorkerThread-2, started 30956)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-2, started 30956)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-2, started 30956)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x0000019A8AAE4490>>
    â”” <Thread(WorkerThread-2, started 30956)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x0000019AB33D7D80>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x0000019A8AAE4490>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x0000019AB33D7060>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_text at 0x0000019A8AA58120>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x0000019AB33D74C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000019AB0B9C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x0000019A8AAF1B40>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x0000019A89F62240>
           â”‚      â”” <function Runner.run at 0x0000019AB0C57EC0>
           â”” <asyncio.runners.Runner object at 0x0000019A8AAF0550>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-76' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000019AB0C559E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x0000019A8AAF0550>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000019AB0C55940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000019AB0C57740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000019AB0B9CEA0>
    â”” <Handle <TaskStepMethWrapper object at 0x0000019A8AAF6E90>()>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle <TaskStepMethWrapper object at 0x0000019A8AAF6E90>()>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle <TaskStepMethWrapper object at 0x0000019A8AAF6E90>()>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle <TaskStepMethWrapper object at 0x0000019A8AAF6E90>()>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_text at 0x0000019A8AA58120>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 9, in transcribe_text
    return await transcribe_audio_and_identify_speakers(file_bytes, filename)
                 â”‚                                      â”‚           â”” 'customer_service_call_fixed.wav'
                 â”‚                                      â”” b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LIST\x1a\x00\x00\x00INFOISF...
                 â”” <function transcribe_audio_and_identify_speakers at 0x0000019AB5B27F60>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 41, in transcribe_audio_and_identify_speakers
    log_artifact_text("raw_transcript.txt", transcript)
    â”‚                                       â”” [{'start': 0.0, 'end': 3.0, 'text': 'Hello. I need help with my recent order.'}, {'start': 5.0, 'end': 8.0, 'text': 'Sure. Ca...
    â”” <function log_artifact_text at 0x0000019AD86F53A0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\utils\mlflow_logger.py", line 20, in log_artifact_text
    with open(filepath, "w", encoding="utf-8") as f:
              â”” '/tmp/raw_transcript.txt'

FileNotFoundError: [Errno 2] No such file or directory: '/tmp/raw_transcript.txt'
2025-04-18 23:22:03.461 | ERROR    | app.services.transcription:transcribe_audio_and_identify_speakers:57 - ðŸ”¥ Exception occurred in transcription pipeline
Traceback (most recent call last):

  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    â”‚    â”” <function Thread._bootstrap_inner at 0x0000019AAEC9EC00>
    â”” <Thread(WorkerThread-3, started 22272)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    â”‚    â”” <function Thread.run at 0x0000019AAEC9E8E0>
    â”” <Thread(WorkerThread-3, started 22272)>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {}
    â”‚    â”‚        â”‚    â”‚        â”” <Thread(WorkerThread-3, started 22272)>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <Thread(WorkerThread-3, started 22272)>
    â”‚    â”” <bound method WorkerThread._entrypoint of <prefect._internal.concurrency.threads.WorkerThread object at 0x0000019A8BB5B810>>
    â”” <Thread(WorkerThread-3, started 22272)>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 90, in _entrypoint
    self._run_until_shutdown()
    â”‚    â”” <function WorkerThread._run_until_shutdown at 0x0000019AB33D7D80>
    â”” <prefect._internal.concurrency.threads.WorkerThread object at 0x0000019A8BB5B810>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\threads.py", line 105, in _run_until_shutdown
    task = call.run()
           â”‚    â”” <function Call.run at 0x0000019AB33D7060>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 272, in run
    return self.context.run(asyncio.run, self._run_async(coro))
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”‚          â”” <coroutine object transcribe_text at 0x0000019A8AB2E420>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”‚    â”” <function Call._run_async at 0x0000019AB33D74C0>
           â”‚    â”‚       â”‚   â”‚       â”‚    â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
           â”‚    â”‚       â”‚   â”‚       â”” <function run at 0x0000019AB0B9C360>
           â”‚    â”‚       â”‚   â”” <module 'asyncio' from 'C:\\Users\\Abhi\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>
           â”‚    â”‚       â”” <method 'run' of '_contextvars.Context' objects>
           â”‚    â”” <_contextvars.Context object at 0x0000019A8BBA0700>
           â”” transcribe_text(b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LI...)
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Call._run_async at 0x0000019AFED357A0>
           â”‚      â”” <function Runner.run at 0x0000019AB0C57EC0>
           â”” <asyncio.runners.Runner object at 0x0000019A8BB962D0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-122' coro=<Call._run_async() running at C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistan...
           â”‚    â”‚     â”” <function BaseEventLoop.run_until_complete at 0x0000019AB0C559E0>
           â”‚    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x0000019A8BB962D0>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    â”‚    â”” <function BaseEventLoop.run_forever at 0x0000019AB0C55940>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    â”‚    â”” <function BaseEventLoop._run_once at 0x0000019AB0C57740>
    â”” <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    â”‚      â”” <function Handle._run at 0x0000019AB0B9CEA0>
    â”” <Handle <TaskStepMethWrapper object at 0x0000019A8BB579A0>()>
  File "C:\Users\Abhi\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    â”‚    â”‚            â”‚    â”‚           â”‚    â”” <member '_args' of 'Handle' objects>
    â”‚    â”‚            â”‚    â”‚           â”” <Handle <TaskStepMethWrapper object at 0x0000019A8BB579A0>()>
    â”‚    â”‚            â”‚    â”” <member '_callback' of 'Handle' objects>
    â”‚    â”‚            â”” <Handle <TaskStepMethWrapper object at 0x0000019A8BB579A0>()>
    â”‚    â”” <member '_context' of 'Handle' objects>
    â”” <Handle <TaskStepMethWrapper object at 0x0000019A8BB579A0>()>
  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\cs_assist\Lib\site-packages\prefect\_internal\concurrency\calls.py", line 345, in _run_async
    result = await coro
                   â”” <coroutine object transcribe_text at 0x0000019A8AB2E420>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\flows\transcription.py", line 9, in transcribe_text
    return await transcribe_audio_and_identify_speakers(file_bytes, filename)
                 â”‚                                      â”‚           â”” 'customer_service_call_fixed.wav'
                 â”‚                                      â”” b'RIFF\xf6)4\x00WAVEfmt \x10\x00\x00\x00\x01\x00\x01\x00D\xac\x00\x00\x88X\x01\x00\x02\x00\x10\x00LIST\x1a\x00\x00\x00INFOISF...
                 â”” <function transcribe_audio_and_identify_speakers at 0x0000019AB5B27F60>

> File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\services\transcription.py", line 41, in transcribe_audio_and_identify_speakers
    log_artifact_text("raw_transcript.txt", transcript)
    â”‚                                       â”” [{'start': 0.0, 'end': 3.0, 'text': 'Hello. I need help with my recent order.'}, {'start': 5.0, 'end': 8.0, 'text': 'Sure. Ca...
    â”” <function log_artifact_text at 0x0000019AD86F53A0>

  File "C:\Users\Abhi\Desktop\mlops\mlops4\customer_service_assistant\app\utils\mlflow_logger.py", line 20, in log_artifact_text
    with open(filepath, "w", encoding="utf-8") as f:
              â”” '/tmp/raw_transcript.txt'

FileNotFoundError: [Errno 2] No such file or directory: '/tmp/raw_transcript.txt'
